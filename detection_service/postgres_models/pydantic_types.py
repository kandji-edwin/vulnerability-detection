from pydantic import BaseModel
from pydantic import constr
from pydantic.typing import Optional


class DeviceModel(BaseModel):
    id: int
    tenant_id: constr(max_length=100)
    device_id: constr(max_length=128)
    app_bundle_version: str
    app_bundle_identifier: str

    class Config:
        orm_mode = True


class AppBundleModel(BaseModel):
    application_name: str
    version: str
    bundle_version: str
    obtained_from: str
    bundle_identifier: str
    process_name: str
    path: str
    cpe_row_id: str

    class Config:
        orm_mode = True


class CPEModel(BaseModel):
    cpe_id: str

    class Config:
        orm_mode = True


class CPECVEMatchModel(BaseModel):
    cpe_row_id: str
    cve_row_id: str


class CVEModel(BaseModel):
    cve_id: str
    version: Optional[str]
    severity: Optional[str]
    score: Optional[str]

    class Config:
        orm_mode = True
